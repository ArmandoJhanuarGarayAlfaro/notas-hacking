# Picker IV

## Descripcion Reto
Can you figure out how this program works to get the flag?

Additional details will be available after launching your challenge instance.

## Pistas
1. (None)

## Solución
```bash
┌──(kali㉿kali)-[~/hacking/examen3]
└─$ ls
picker-IV  picker-IV.c

                                 p@@�@@�0�0+�0 ▒        �7��:                                                                                  
┌──(kali㉿kali)-[~/hacking/examen3]
┌──(kali㉿kali)-[~/hacking/examen3]
└─$ cat picker-IV.c 
#include <stdio.h>
#include <stdlib.h>
#include <signal.h>
#include <unistd.h>


void print_segf_message(){
  printf("Segfault triggered! Exiting.\n");
  sleep(15);
  exit(SIGSEGV);
}

int win() {
  FILE *fptr;
  char c;

  printf("You won!\n");
  // Open file
  fptr = fopen("flag.txt", "r");
  if (fptr == NULL)
  {
      printf("Cannot open file.\n");
      exit(0);
  }

  // Read contents from file
  c = fgetc(fptr);
  while (c != EOF)
  {
      printf ("%c", c);
      c = fgetc(fptr);
  }

  printf("\n");
  fclose(fptr);
}

int main() {
  signal(SIGSEGV, print_segf_message);
  setvbuf(stdout, NULL, _IONBF, 0); // _IONBF = Unbuffered

  unsigned int val;
  printf("Enter the address in hex to jump to, excluding '0x': ");
  scanf("%x", &val);
  printf("You input 0x%x\n", val);

  void (*foo)(void) = (void (*)())val;
  foo();
}


┌──(kali㉿kali)-[~/hacking/examen3]
└─$ gdb picker-IV      


(gdb) break win
Breakpoint 1 at 0x4012a6
(gdb) run
Starting program: /home/kali/hacking/examen3/picker-IV 
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Enter the address in hex to jump to, excluding '0x': 0xdddddddd
You input 0xdddddddd

Program received signal SIGSEGV, Segmentation fault.
0x00000000dddddddd in ?? ()
(gdb) info address win
Symbol "win" is at 0x40129e in a file compiled without debugging.
(gdb) set $rip=0x40129e
(gdb) continue
Continuing.
Segfault triggered! Exiting.
[Inferior 1 (process 84481) exited with code 013]
(gdb) 

┌──(kali㉿kali)-[~/hacking/examen3]
└─$ nc saturn.picoctf.net 57136
Enter the address in hex to jump to, excluding '0x': 0x40129e
You input 0x40129e
You won!
picoCTF{n3v3r_jump_t0_u53r_5uppl13d_4ddr35535_14bc5444}


```

## Bandera
* picoCTF{n3v3r_jump_t0_u53r_5uppl13d_4ddr35535_14bc5444}


## Notas adicionales
| Comando | Descripcion |
|---------|-------------|
|  |  |

## Referencias
- []()